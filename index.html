<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="PFANDA - Die moderne Lösung für Pfandflaschen. Einfach, nachhaltig und fair für alle.">
    <meta name="keywords" content="Pfand, Pfandflaschen, Recycling, Nachhaltigkeit, Umweltschutz">
    <meta name="author" content="PFANDA">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://pfanda.github.io/">
    <meta property="og:title" content="PFANDA - Die moderne Pfandlösung">
    <meta property="og:description" content="PFANDA - Die moderne Lösung für Pfandflaschen. Einfach, nachhaltig und fair für alle.">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://pfanda.github.io/">
    <meta property="twitter:title" content="PFANDA - Die moderne Pfandlösung">
    <meta property="twitter:description" content="PFANDA - Die moderne Lösung für Pfandflaschen. Einfach, nachhaltig und fair für alle.">
    
    <title>PFANDA - Die moderne Pfandlösung</title>
    
    <!-- Favicons -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="512x512" href="/assets/img/favicon-512x512.png">
    <link rel="apple-touch-icon" sizes="512x512" href="/assets/img/favicon-512x512.png">
    
    <link rel="stylesheet" href="/assets/css/styles.css?v=106">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="navbar-content">
            <a href="/" class="brand">
                <img src="/assets/img/PFANDA LOGO 2.png" alt="PFANDA Logo" class="brand-logo">
                <span class="logo">PFANDA</span>
            </a>
            <button class="menu-toggle" aria-label="Menü öffnen">Menu [+]</button>
            <ul class="nav-menu">
                <li><a href="/">Start</a></li>
                <li><a href="/pfandgeber/">Pfandgeber</a></li>
                <li><a href="/abholer/">Abholer</a></li>
                <li><a href="/faq/">FAQ</a></li>
                <li><a href="/kontakt/">Kontakt</a></li>
            </ul>
        </div>
    </nav>

    <!-- Hero Section - Conversion Optimized -->
    <!-- Full-width Hero mit min. 80vh, vertikal zentriert, dezenter Farbverlauf -->
    <section class="hero" id="hero" style="background-image: url('/assets/img/website-start-bild (2).png'); background-size: cover; background-position: center; width: 100%; min-height: 100vh !important; height: 100vh !important;">
        <div class="hero-content">
            <!-- Eyebrow (klein) -->
            <p class="value-proposition" style="font-size: 1.5rem; margin-bottom: var(--spacing-md); text-transform: uppercase; letter-spacing: 0.1em; opacity: 0.9;">
                Recycling verbindet
            </p>
            
            <!-- Headline -->
            <h1 style="margin-bottom: var(--spacing-lg); font-size: 4rem; line-height: 1.2;">
                Pfand abholen lassen.<br>
                Einfach. Sicher. Lokal.
            </h1>
            
            <!-- Subheadline -->
            <p class="subheadline" style="font-size: 1.5rem; line-height: 1.7; max-width: 600px;">
                PFANDA verbindet Menschen, die ihr Pfand bequem loswerden wollen, mit Abholern in der Nähe – transparent und organisiert per App.
            </p>
            
            <!-- CTA Buttons: Primary (Warteliste) + Secondary (So funktioniert's) -->
            <!-- Buttons sind klar visuell unterscheidbar: Primary = gefüllt, Secondary = Outline -->
            <div class="hero-cta">
                <a href="#so-funktionierts" class="btn btn-secondary">So funktioniert's</a>
                <a href="#warteliste" class="btn">Zur Warteliste</a>
            </div>
        </div>
    </section>

    <!-- "So funktioniert's" Sektion -->
    <!-- Scroll-Anker für Secondary CTA Button -->
    <section class="section" id="so-funktionierts" style="background-color: var(--color-white);">
        <div class="container">
            <h2 class="section-title" style="margin-bottom: var(--spacing-md);">So funktioniert PFANDA</h2>
            
            <!-- Pfandgeber: Text links, Mockup rechts -->
            <div class="feature-row">
                <div class="card feature-card">
                    <h3 class="card-title">Für Pfandgeber</h3>
                    <ol style="padding-left: var(--spacing-lg); color: var(--color-text);">
                        <li style="margin-bottom: var(--spacing-xs);">Pfand sammeln</li>
                        <li style="margin-bottom: var(--spacing-xs);">Abholung in der App anlegen</li>
                        <li style="margin-bottom: var(--spacing-xs);">Ein Abholer in deiner Nähe nimmt den Auftrag an</li>
                        <li style="margin-bottom: var(--spacing-xs);">Pfand übergeben & deinen Anteil erhalten</li>
                    </ol>
                    <a href="/pfandgeber/" class="btn" style="margin-top: var(--spacing-sm);">So gebe ich Pfand ab</a>
                    <div class="flasche-image-wrapper">
                        <img src="/assets/img/Flasche-rechts.png" alt="Flasche rechts" class="flasche-image">
                    </div>
                </div>
                <div class="mockup-card feature-mockup">
                    <div class="mockup-image-wrapper">
                        <img src="/assets/img/Mockup-DetailView.png?v=2" 
                             alt="PFANDA App Detail-Ansicht" 
                             class="mockup-image">
                    </div>
                </div>
            </div>
            
            <!-- Abholer: Text links, Mockup rechts -->
            <div class="feature-row feature-row-reverse">
                <div class="card feature-card">
                    <h3 class="card-title">Für Abholer</h3>
                    <ol style="padding-left: var(--spacing-lg); color: var(--color-text);">
                        <li style="margin-bottom: var(--spacing-xs);">Als Abholer registrieren</li>
                        <li style="margin-bottom: var(--spacing-xs);">Aufträge in deiner Nähe finden</li>
                        <li style="margin-bottom: var(--spacing-xs);">Pfand abholen</li>
                        <li style="margin-bottom: var(--spacing-xs);">Pfand einlösen & Geld verdienen</li>
                    </ol>
                    <a href="/abholer/" class="btn" style="margin-top: var(--spacing-sm);">So werde ich Abholer</a>
                    <div class="flasche-image-wrapper">
                        <img src="/assets/img/Flasche-links.png" alt="Flasche links" class="flasche-image">
                    </div>
                </div>
                <div class="mockup-card feature-mockup">
                    <div class="mockup-image-wrapper">
                        <img src="/assets/img/Mockup-Map.png?v=1" 
                             alt="PFANDA App Karten-Ansicht" 
                             class="mockup-image mockup-image-large">
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Wartelisten-Sektion -->
    <!-- Ruhige Card-Optik mit abgesetztem Hintergrund für bessere Conversion -->
    <section class="waitlist-section" id="warteliste" style="background-image: url('/assets/img/Background-Tafel.png'); background-size: cover; background-position: center;">
        <div class="container">
            <div class="waitlist-card">
                <!-- Überschrift: Kurz & motivierend -->
                <h2 class="section-title">Sei beim Start dabei.</h2>
                
                <!-- Text: Erklärung, warum sich Eintragung lohnt -->
                <p class="waitlist-intro" style="text-align: center; color: var(--color-text-light); margin-bottom: var(--spacing-sm);">
                    Trag dich ein und wir melden uns, sobald PFANDA in deiner Region verfügbar ist.
                </p>
                <p style="text-align: center; color: var(--color-text-light); margin-bottom: var(--spacing-lg); font-size: var(--font-size-sm);">
                    PFANDA befindet sich aktuell in der Vorbereitungsphase. Der Start ist in den nächsten Wochen geplant.
                </p>
                
                <!-- Formular -->
                <form class="waitlist-form" id="waitlistForm">
                    <!-- Feld: Rolle (Pflicht) -->
                    <div class="form-group">
                        <label for="waitlist-role" class="form-label">Ich bin… *</label>
                        <select id="waitlist-role" name="role" class="form-select" required>
                            <option value="">Bitte wählen</option>
                            <option value="pfandgeber">Pfandgeber (Ich möchte Pfand abholen lassen)</option>
                            <option value="abholer">Abholer (Ich möchte Pfand abholen)</option>
                        </select>
                    </div>
                    
                    <!-- Feld: PLZ (Pflicht) -->
                    <div class="form-group">
                        <label for="waitlist-plz" class="form-label">PLZ *</label>
                        <input type="text" id="waitlist-plz" name="plz" class="form-input" placeholder="z. B. 1010" required pattern="[0-9]{4,5}" maxlength="5">
                        <small style="color: var(--color-text-light); font-size: var(--font-size-sm); display: block; margin-top: var(--spacing-xs);">
                            Damit wir wissen, wo PFANDA zuerst startet.
                        </small>
                    </div>
                    
                    <!-- Feld: Name (optional) -->
                    <div class="form-group">
                        <label for="waitlist-name" class="form-label">Name (optional)</label>
                        <input type="text" id="waitlist-name" name="name" class="form-input" placeholder="Ihr Name">
                    </div>
                    
                    <!-- Feld: E-Mail (Pflicht) -->
                    <div class="form-group">
                        <label for="waitlist-email" class="form-label">E-Mail *</label>
                        <input type="email" id="waitlist-email" name="email" class="form-input" placeholder="ihre@email.at" required>
                    </div>
                    
                    <button type="submit" class="btn" style="width: 100%;">Auf die Warteliste</button>
                    
                    <!-- Hinweis unter dem Button -->
                    <p style="text-align: center; font-size: var(--font-size-sm); color: var(--color-text-light); margin-top: var(--spacing-md);">
                        Wir senden dir ausschließlich Updates, sobald PFANDA live geht.<br>
                        <a href="/datenschutz/" style="color: var(--color-primary);">Datenschutz</a>
                    </p>
                </form>
                
                <!-- Success-Message: Wird nach erfolgreichem Submit angezeigt -->
                <div class="waitlist-success" id="waitlistSuccess">
                    <h3 style="color: var(--color-primary); margin-bottom: var(--spacing-sm);">✓ Danke!</h3>
                    <p style="color: var(--color-text-light);">
                        Wir melden uns, sobald PFANDA in deiner Region startet.
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!-- Mission Sektion -->
    <section class="mission-section" id="mission">
        <div class="mission-container">
            <!-- Linke Seite: Missionstext -->
            <div class="mission-text">
                <h2 class="mission-title" style="color: var(--color-primary);">Unsere Mission</h2>
                <p class="mission-content">
                    PFANDA ist eine mobile App, die das Zurückgeben und Recyclen von Pfandflaschen vereinfacht. 
                    Wir verbinden Menschen, die ihre Pfandflaschen bequem loswerden möchten, mit Abholern in ihrer Nähe 
                    und organisieren den gesamten Prozess digital. Unser Ziel ist es, Recycling zugänglicher zu machen 
                    und einen positiven Beitrag zur Umwelt zu leisten – lokal, bequem und nachhaltig.
                </p>
            </div>
            
            <!-- Rechte Seite: Tafel mit Logo -->
            <div class="mission-image">
                <div class="mission-logo-wrapper">
                    <img src="/assets/img/PFANDA logo only.png" alt="PFANDA Logo" class="mission-logo">
                </div>
            </div>
        </div>
    </section>

    <!-- Transparenter Ablauf Sektion -->
    <section class="section" style="background-color: var(--color-bg);">
        <!-- 2-Spalten-Layout: Flaschensack links, Text rechts (wie Mission) -->
        <div class="transparency-container">
            <!-- Linke Seite: Flaschensack Bild -->
            <div class="transparency-image">
                <div class="flaschensack-wrapper">
                    <img src="/assets/img/Flaschensack.png" alt="Flaschensack" class="flaschensack-image">
                </div>
            </div>
            
            <!-- Rechte Seite: Text-Block -->
            <div class="transparency-text">
                <h3 class="transparency-title">Faire Aufteilung des Pfandbetrags</h3>
                <p class="transparency-content">
                    Beim Erstellen eines Auftrags legt der Pfandgeber fest,<br>
                    welchen Anteil des Pfandbetrags der Abholer erhält.
                </p>
            </div>
        </div>
        
        <div class="container">
            <div class="trust-timeline">
                <!-- Hauptüberschrift -->
                <h3 style="text-align: center; margin-bottom: var(--spacing-xl); margin-top: var(--spacing-lg); color: var(--color-primary); font-size: 2.75rem;">Transparenter Ablauf</h3>
                
                <!-- Timeline Steps -->
                <div class="timeline-steps">
                    <div class="timeline-step">
                        <div class="timeline-number">1</div>
                        <h4 style="margin-bottom: var(--spacing-sm); color: var(--color-primary); font-size: 1.5rem;">Auftragsannahme & Reservierung</h4>
                        <p style="color: var(--color-text); font-size: 1.125rem; line-height: 1.7;">
                            Sobald ein Abholer einen Auftrag annimmt, wird der vereinbarte Betrag bei ihm reserviert.<br>
                            So ist sichergestellt, dass die Auszahlung nach der Abholung garantiert ist.
                        </p>
                    </div>
                    <div class="timeline-connector"></div>
                    <div class="timeline-step">
                        <div class="timeline-number">2</div>
                        <h4 style="margin-bottom: var(--spacing-sm); color: var(--color-primary); font-size: 1.5rem;">Abholung</h4>
                        <p style="color: var(--color-text); font-size: 1.125rem; line-height: 1.7;">
                            <br>
                            Der Abholer holt das Pfand zum vereinbarten Zeitpunkt ab.<br>
                            Währenddessen bleibt der Betrag reserviert.
                        </p>
                    </div>
                    <div class="timeline-connector"></div>
                    <div class="timeline-step">
                        <div class="timeline-number">3</div>
                        <h4 style="margin-bottom: var(--spacing-sm); color: var(--color-primary); font-size: 1.5rem;">Bestätigung & Auszahlung</h4>
                        <p style="color: var(--color-text); font-size: 1.125rem; line-height: 1.7;">
                            Nach der bestätigten Abholung wird der reservierte Betrag freigegeben<br>
                            und entsprechend der festgelegten Aufteilung ausgezahlt.
                        </p>
                    </div>
                </div>
                
                <!-- Flaschenübergabe Bild -->
                <div class="flaschenuebergabe-wrapper" style="display: flex; justify-content: center; margin-top: var(--spacing-xxl);">
                    <img src="/assets/img/Flaschenübergabe.png" alt="Flaschenübergabe" class="flaschenuebergabe-image">
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>PFANDA<sup>®</sup></h3>
                    <p style="color: #ffffff;">Die moderne Lösung für Pfandflaschen. Nachhaltig, einfach und fair.</p>
                </div>
                <div class="footer-section">
                    <h3>Navigation</h3>
                    <ul class="footer-links">
                        <li><a href="/">Start</a></li>
                        <li><a href="/pfandgeber/">Pfandgeber</a></li>
                        <li><a href="/abholer/">Abholer</a></li>
                        <li><a href="/faq/">FAQ</a></li>
                        <li><a href="/kontakt/">Kontakt</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>Rechtliches</h3>
                    <ul class="footer-links">
                        <li><a href="/impressum/">Impressum</a></li>
                        <li><a href="/datenschutz/">Datenschutz</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>2026 PFANDA<sup>®</sup>. Alle Rechte vorbehalten.</p>
            </div>
        </div>
    </footer>

    <!-- Supabase Configuration - Direkter REST API Zugriff (ohne Auth, RLS deaktiviert) -->
    <script>
        // Supabase Configuration für direkten REST API Aufruf
        const SUPABASE_URL = 'https://qbmykhvivrfswuglkwkv.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFibXlraHZpdnJmc3d1Z2xrd2t2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg3Mzg3MzcsImV4cCI6MjA4NDMxNDczN30.QknWaZcfRtBCNtrKOVh0dswBy7GEHzPfeUhvrrohGdg';
        
        // Funktion für direkten Supabase REST API Aufruf
        async function insertToSupabase(table, data) {
            const url = `${SUPABASE_URL}/rest/v1/${table}`;
            console.log('Supabase Insert:', { url, data });
            
            const response = await fetch(url, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'apikey': SUPABASE_ANON_KEY,
                    'Authorization': `Bearer ${SUPABASE_ANON_KEY}`,
                    'Prefer': 'return=representation'
                },
                body: JSON.stringify(data)
            });
            
            console.log('Supabase Response Status:', response.status);
            
            if (!response.ok) {
                const errorText = await response.text();
                let errorData;
                try {
                    errorData = JSON.parse(errorText);
                } catch (e) {
                    errorData = { message: errorText || response.statusText };
                }
                console.error('Supabase Error:', { 
                    status: response.status, 
                    statusText: response.statusText,
                    errorData 
                });
                throw { 
                    code: response.status, 
                    message: errorData.message || errorData.error_description || errorData.hint || 'Unknown error',
                    details: errorData
                };
            }
            
            const result = await response.json();
            console.log('Supabase Success:', result);
            return result;
        }
        
        console.log('Supabase REST API bereit');
    </script>
    <!-- Main JavaScript -->
    <script src="/assets/js/main.js"></script>
    <!-- Wartelisten-Formular JavaScript -->
    <script>
        // Wartelisten-Formular: Verbunden mit Supabase
        (function() {
            const waitlistForm = document.getElementById('waitlistForm');
            const waitlistSuccess = document.getElementById('waitlistSuccess');
            
            if (waitlistForm) {
                waitlistForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    // Validierung
                    const roleInput = document.getElementById('waitlist-role');
                    const plzInput = document.getElementById('waitlist-plz');
                    const emailInput = document.getElementById('waitlist-email');
                    
                    const role = roleInput.value.trim();
                    const plz = plzInput.value.trim();
                    const email = emailInput.value.trim();
                    
                    // Error Messages
                    let errorMessage = '';
                    
                    if (!role) {
                        errorMessage = 'Bitte Rolle auswählen.';
                        roleInput.style.borderColor = '#dc3545';
                    } else {
                        roleInput.style.borderColor = '';
                    }
                    
                    if (!plz) {
                        errorMessage = 'Bitte PLZ eingeben.';
                        plzInput.style.borderColor = '#dc3545';
                    } else if (!/^[0-9]{4,5}$/.test(plz)) {
                        errorMessage = 'Bitte eine gültige PLZ eingeben (4-5 Ziffern).';
                        plzInput.style.borderColor = '#dc3545';
                    } else {
                        plzInput.style.borderColor = '';
                    }
                    
                    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                    if (!email) {
                        errorMessage = 'Bitte E-Mail eingeben.';
                        emailInput.style.borderColor = '#dc3545';
                    } else if (!emailRegex.test(email)) {
                        errorMessage = 'Bitte eine gültige E-Mail eingeben.';
                        emailInput.style.borderColor = '#dc3545';
                    } else {
                        emailInput.style.borderColor = '';
                    }
                    
                    if (errorMessage) {
                        alert(errorMessage);
                        return;
                    }
                    
                    // Konvertiere Rolle zu Datenbank-Format (Pfandgeber/Abholer)
                    const roleDb = role === 'pfandgeber' ? 'Pfandgeber' : 'Abholer';
                    const nameValue = document.getElementById('waitlist-name').value.trim() || null;
                    
                    // Daten in Supabase speichern - direkter REST API Aufruf (RLS deaktiviert)
                    async function submitToSupabase() {
                        try {
                            // Zeige Loading-State
                            const submitButton = waitlistForm.querySelector('button[type="submit"]');
                            const originalButtonText = submitButton.textContent;
                            submitButton.disabled = true;
                            submitButton.textContent = 'Wird gespeichert...';
                            
                            // Direkter REST API Aufruf (RLS ist deaktiviert, sollte funktionieren)
                            const data = await insertToSupabase('waitlist_signups', {
                                role: roleDb,
                                postal_code: plz,
                                name: nameValue,
                                email: email
                            });
                            
                            // Erfolgreich gespeichert
                            console.log('Erfolgreich in Supabase gespeichert:', data);
                            
                            // Formular ausblenden
                            waitlistForm.classList.add('hidden');
                            
                            // Success-Message anzeigen
                            waitlistSuccess.classList.add('active');
                            
                            // Scroll zu Success-Message für bessere UX
                            waitlistSuccess.scrollIntoView({ behavior: 'smooth', block: 'center' });
                            
                            // Formular zurücksetzen (optional)
                            waitlistForm.reset();
                            
                        } catch (err) {
                            console.error('Supabase Error:', err);
                            console.error('Error Details:', err.details);
                            
                            // Button zurücksetzen
                            const submitButton = waitlistForm.querySelector('button[type="submit"]');
                            submitButton.disabled = false;
                            submitButton.textContent = 'Auf die Warteliste';
                            
                            // Spezielle Fehlermeldungen basierend auf Error-Code
                            if (err.code === 409 || err.code === '23505' || (err.message && err.message.includes('duplicate'))) {
                                alert('Diese E-Mail-Adresse ist bereits auf der Warteliste. Vielen Dank für dein Interesse!');
                            } else if (err.code === 400 || err.code === 422) {
                                alert('Ungültige Eingabe. Bitte überprüfe deine Angaben.\n\nFehler: ' + (err.message || ''));
                            } else if (err.code === 404) {
                                alert('Die Datenbank-Tabelle wurde nicht gefunden. Bitte überprüfe die Migration.');
                            } else {
                                alert('Fehler beim Speichern: ' + (err.message || 'Bitte versuche es später erneut.'));
                            }
                        }
                    }
                    
                    // Supabase Submit aufrufen
                    submitToSupabase();
                });
            }
        })();
    </script>
</body>
</html>
